============================= test session starts =============================
platform win32 -- Python 3.11.4, pytest-7.4.0, pluggy-1.0.0 -- C:\Users\hodibi\AppData\Local\anaconda3\python.exe
cachedir: .pytest_cache
rootdir: c:\Users\hodibi\OneDrive - Ingredion\Desktop\Repos\Odibi
configfile: pytest.ini
testpaths: tests
plugins: anyio-3.5.0, dash-3.0.2, Faker-37.3.0
collecting ... collected 137 items

tests/test_azure_adls_auth.py::TestAzureADLSValidation::test_validation_key_vault_mode_missing_vault_name PASSED [  0%]
tests/test_azure_adls_auth.py::TestAzureADLSValidation::test_validation_key_vault_mode_missing_secret_name PASSED [  1%]
tests/test_azure_adls_auth.py::TestAzureADLSValidation::test_validation_direct_key_mode_missing_account_key PASSED [  2%]
tests/test_azure_adls_auth.py::TestAzureADLSValidation::test_validation_unsupported_auth_mode PASSED [  2%]
tests/test_azure_adls_auth.py::TestAzureADLSValidation::test_validation_missing_account PASSED [  3%]
tests/test_azure_adls_auth.py::TestAzureADLSValidation::test_validation_missing_container PASSED [  4%]
tests/test_azure_adls_auth.py::TestAzureADLSValidation::test_validation_success_key_vault_mode PASSED [  5%]
tests/test_azure_adls_auth.py::TestAzureADLSValidation::test_validation_success_direct_key_mode PASSED [  5%]
tests/test_azure_adls_auth.py::TestAzureADLSDirectKeyAuth::test_get_storage_key_direct_key PASSED [  6%]
tests/test_azure_adls_auth.py::TestAzureADLSDirectKeyAuth::test_production_warning_direct_key PASSED [  7%]
tests/test_azure_adls_auth.py::TestAzureADLSDirectKeyAuth::test_no_warning_direct_key_non_production PASSED [  8%]
tests/test_azure_adls_auth.py::TestAzureADLSKeyVaultAuth::test_get_storage_key_key_vault PASSED [  8%]
tests/test_azure_adls_auth.py::TestAzureADLSKeyVaultAuth::test_caching_key_vault PASSED [  9%]
tests/test_azure_adls_auth.py::TestAzureADLSPandasIntegration::test_pandas_storage_options_direct_key PASSED [ 10%]
tests/test_azure_adls_auth.py::TestAzureADLSPandasIntegration::test_pandas_storage_options_key_vault PASSED [ 10%]
tests/test_azure_adls_auth.py::TestAzureADLSSparkIntegration::test_configure_spark_direct_key PASSED [ 11%]
tests/test_azure_adls_auth.py::TestAzureADLSSparkIntegration::test_configure_spark_key_vault PASSED [ 12%]
tests/test_azure_adls_auth.py::TestAzureADLSURIGeneration::test_uri_simple_path PASSED [ 13%]
tests/test_azure_adls_auth.py::TestAzureADLSURIGeneration::test_uri_with_path_prefix PASSED [ 13%]
tests/test_azure_adls_auth.py::TestAzureADLSURIGeneration::test_uri_handles_leading_slash PASSED [ 14%]
tests/test_azure_adls_auth.py::TestAzureADLSURIGeneration::test_get_path_delegates_to_uri PASSED [ 15%]
tests/test_config.py::TestReadConfig::test_valid_read_config_with_path PASSED [ 16%]
tests/test_config.py::TestReadConfig::test_valid_read_config_with_table PASSED [ 16%]
tests/test_config.py::TestReadConfig::test_read_config_requires_path_or_table PASSED [ 17%]
tests/test_config.py::TestReadConfig::test_read_config_with_options PASSED [ 18%]
tests/test_config.py::TestWriteConfig::test_valid_write_config PASSED    [ 18%]
tests/test_config.py::TestWriteConfig::test_write_config_default_mode PASSED [ 19%]
tests/test_config.py::TestWriteConfig::test_write_config_append_mode PASSED [ 20%]
tests/test_config.py::TestTransformConfig::test_transform_with_sql_strings PASSED [ 21%]
tests/test_config.py::TestTransformConfig::test_transform_with_dict_steps PASSED [ 21%]
tests/test_config.py::TestNodeConfig::test_valid_node_with_read_only PASSED [ 22%]
tests/test_config.py::TestNodeConfig::test_valid_node_with_all_operations PASSED [ 23%]
tests/test_config.py::TestNodeConfig::test_node_requires_at_least_one_operation PASSED [ 24%]
tests/test_config.py::TestNodeConfig::test_node_with_dependencies PASSED [ 24%]
tests/test_config.py::TestNodeConfig::test_node_with_cache PASSED        [ 25%]
tests/test_config.py::TestNodeConfig::test_node_cache_default_false PASSED [ 26%]
tests/test_config.py::TestPipelineConfig::test_valid_pipeline PASSED     [ 27%]
tests/test_config.py::TestPipelineConfig::test_pipeline_rejects_duplicate_node_names PASSED [ 27%]
tests/test_config.py::TestPipelineConfig::test_pipeline_with_layer PASSED [ 28%]
tests/test_config.py::TestProjectConfig::test_minimal_project_config PASSED [ 29%]
tests/test_config.py::TestProjectConfig::test_project_with_connections PASSED [ 29%]
tests/test_config.py::TestProjectConfig::test_project_default_engine_is_pandas PASSED [ 30%]
tests/test_config.py::TestProjectConfig::test_project_can_set_spark_engine PASSED [ 31%]
tests/test_config.py::TestProjectConfig::test_project_with_global_settings PASSED [ 32%]
tests/test_config.py::TestConnectionConfigs::test_local_connection_config PASSED [ 32%]
tests/test_config.py::TestConnectionConfigs::test_local_connection_default_path PASSED [ 33%]
tests/test_connections_paths.py::test_azure_adls_uri_basic PASSED        [ 34%]
tests/test_connections_paths.py::test_azure_adls_uri_with_prefix PASSED  [ 35%]
tests/test_connections_paths.py::test_azure_adls_uri_with_leading_slash PASSED [ 35%]
tests/test_connections_paths.py::test_azure_sql_dsn_with_managed_identity PASSED [ 36%]
tests/test_connections_paths.py::test_azure_sql_dsn_with_sql_auth PASSED [ 37%]
tests/test_connections_paths.py::test_local_dbfs_resolve PASSED          [ 37%]
tests/test_connections_paths.py::test_local_dbfs_resolve_without_prefix PASSED [ 38%]
tests/test_connections_paths.py::test_local_dbfs_default_root PASSED     [ 39%]
tests/test_context.py::TestPandasContext::test_register_and_get_dataframe PASSED [ 40%]
tests/test_context.py::TestPandasContext::test_has_returns_true_for_registered PASSED [ 40%]
tests/test_context.py::TestPandasContext::test_get_raises_keyerror_for_missing PASSED [ 41%]
tests/test_context.py::TestPandasContext::test_get_error_shows_available_names PASSED [ 42%]
tests/test_context.py::TestPandasContext::test_list_names_returns_all_registered PASSED [ 43%]
tests/test_context.py::TestPandasContext::test_clear_removes_all_dataframes PASSED [ 43%]
tests/test_context.py::TestPandasContext::test_register_overwrites_existing PASSED [ 44%]
tests/test_context.py::TestPandasContext::test_register_validates_dataframe_type PASSED [ 45%]
tests/test_context.py::TestContextFactory::test_create_pandas_context PASSED [ 45%]
tests/test_context.py::TestContextFactory::test_create_context_invalid_engine PASSED [ 46%]
tests/test_context.py::TestContextDataIsolation::test_different_contexts_are_isolated PASSED [ 47%]
tests/test_context.py::TestContextUsagePatterns::test_chaining_multiple_dataframes PASSED [ 48%]
tests/test_delta_pandas.py::TestDeltaWrite::test_write_delta_basic SKIPPEDeltalake') [ 48%]
tests/test_delta_pandas.py::TestDeltaWrite::test_write_delta_append SKIPPEDeltalake') [ 49%]
tests/test_delta_pandas.py::TestDeltaWrite::test_write_delta_with_partitioning SKIPPEDeltalake') [ 50%]
tests/test_delta_pandas.py::TestDeltaRead::test_read_delta_basic SKIPPEDeltalake') [ 51%]
tests/test_delta_pandas.py::TestDeltaRead::test_read_delta_time_travel SKIPPEDeltalake') [ 51%]
tests/test_delta_pandas.py::TestDeltaVacuum::test_vacuum_delta SKIPPEDdeltalake') [ 52%]
tests/test_delta_pandas.py::TestDeltaVacuum::test_vacuum_delta_dry_run SKIPPEDeltalake') [ 53%]
tests/test_delta_pandas.py::TestDeltaHistory::test_get_delta_history SKIPPEDeltalake') [ 54%]
tests/test_delta_pandas.py::TestDeltaHistory::test_get_delta_history_with_limit SKIPPEDeltalake') [ 54%]
tests/test_delta_pandas.py::TestDeltaRestore::test_restore_delta SKIPPEDeltalake') [ 55%]
tests/test_delta_pandas.py::TestDeltaErrorHandling::test_read_nonexistent_delta_table SKIPPEDeltalake') [ 56%]
tests/test_delta_pandas.py::TestDeltaErrorHandling::test_write_delta_import_error SKIPPEDeltalake') [ 56%]
tests/test_extras_imports.py::test_spark_engine_import_without_pyspark PASSED [ 57%]
tests/test_extras_imports.py::test_spark_engine_import_with_pyspark PASSED [ 58%]
tests/test_extras_imports.py::test_spark_engine_methods_not_implemented PASSED [ 59%]
tests/test_graph.py::TestDependencyGraph::test_simple_linear_graph PASSED [ 59%]
tests/test_graph.py::TestDependencyGraph::test_parallel_nodes PASSED     [ 60%]
tests/test_graph.py::TestDependencyGraph::test_complex_diamond_graph PASSED [ 61%]
tests/test_graph.py::TestCycleDetection::test_direct_cycle PASSED        [ 62%]
tests/test_graph.py::TestCycleDetection::test_indirect_cycle PASSED      [ 62%]
tests/test_graph.py::TestCycleDetection::test_self_dependency PASSED     [ 63%]
tests/test_graph.py::TestMissingDependencies::test_missing_dependency PASSED [ 64%]
tests/test_graph.py::TestMissingDependencies::test_multiple_missing_dependencies PASSED [ 64%]
tests/test_graph.py::TestGraphAnalysis::test_get_dependencies PASSED     [ 65%]
tests/test_graph.py::TestGraphAnalysis::test_get_dependents PASSED       [ 66%]
tests/test_graph.py::TestGraphAnalysis::test_get_independent_nodes PASSED [ 67%]
tests/test_graph.py::TestExecutionLayers::test_single_layer PASSED       [ 67%]
tests/test_graph.py::TestExecutionLayers::test_multiple_layers PASSED    [ 68%]
tests/test_graph.py::TestVisualization::test_visualize_simple_graph PASSED [ 69%]
tests/test_pipeline.py::TestPipelineExecution::test_simple_read_only_pipeline PASSED [ 70%]
tests/test_pipeline.py::TestPipelineExecution::test_pipeline_with_dependencies PASSED [ 70%]
tests/test_pipeline.py::TestPipelineExecution::test_pipeline_writes_output PASSED [ 71%]
tests/test_pipeline.py::TestPipelineFailures::test_failed_node_skips_dependents PASSED [ 72%]
tests/test_pipeline.py::TestPipelineFailures::test_independent_nodes_continue_after_failure PASSED [ 72%]
tests/test_pipeline.py::TestPipelineValidation::test_validate_simple_pipeline PASSED [ 73%]
tests/test_pipeline.py::TestPipelineValidation::test_validate_detects_missing_connections PASSED [ 74%]
tests/test_pipeline.py::TestRunSingleNode::test_run_node_with_mock_data PASSED [ 75%]
tests/test_pipeline.py::TestPipelineResults::test_results_to_dict PASSED [ 75%]
tests/test_registry.py::TestTransformDecorator::test_decorator_registers_function PASSED [ 76%]
tests/test_registry.py::TestTransformDecorator::test_decorated_function_still_callable PASSED [ 77%]
tests/test_registry.py::TestTransformDecorator::test_can_register_multiple_functions PASSED [ 78%]
tests/test_registry.py::TestFunctionRegistry::test_get_registered_function PASSED [ 78%]
tests/test_registry.py::TestFunctionRegistry::test_get_unregistered_function_raises_error PASSED [ 79%]
tests/test_registry.py::TestFunctionRegistry::test_error_shows_available_functions PASSED [ 80%]
tests/test_registry.py::TestFunctionRegistry::test_list_functions_returns_all_names PASSED [ 81%]
tests/test_registry.py::TestParameterValidation::test_validate_required_parameters PASSED [ 81%]
tests/test_registry.py::TestParameterValidation::test_validate_catches_missing_required_param PASSED [ 82%]
tests/test_registry.py::TestParameterValidation::test_validate_allows_optional_params PASSED [ 83%]
tests/test_registry.py::TestParameterValidation::test_validate_catches_unexpected_params PASSED [ 83%]
tests/test_registry.py::TestParameterValidation::test_validate_ignores_context_param PASSED [ 84%]
tests/test_registry.py::TestFunctionInfo::test_get_function_info PASSED  [ 85%]
tests/test_registry.py::TestFunctionInfo::test_function_info_shows_required_vs_optional PASSED [ 86%]
tests/test_registry.py::TestGetRegisteredFunction::test_get_registered_function_helper PASSED [ 86%]
tests/test_registry.py::TestValidateFunctionParams::test_validate_function_params_helper PASSED [ 87%]
tests/test_registry.py::TestRealWorldUsage::test_transform_function_with_dataframe_operations PASSED [ 88%]
tests/test_registry.py::TestRealWorldUsage::test_multiple_params_with_defaults PASSED [ 89%]
tests/test_setup_helpers.py::TestKeyVaultFetchResult::test_success_result PASSED [ 89%]
tests/test_setup_helpers.py::TestKeyVaultFetchResult::test_error_result PASSED [ 90%]
tests/test_setup_helpers.py::TestFetchKeyvaultSecret::test_successful_fetch PASSED [ 91%]
tests/test_setup_helpers.py::TestFetchKeyvaultSecret::test_fetch_with_exception PASSED [ 91%]
tests/test_setup_helpers.py::TestFetchKeyvaultSecret::test_import_error_handling PASSED [ 92%]
tests/test_setup_helpers.py::TestFetchKeyvaultSecretsParallel::test_no_keyvault_connections PASSED [ 93%]
tests/test_setup_helpers.py::TestFetchKeyvaultSecretsParallel::test_parallel_fetch_success PASSED [ 94%]
tests/test_setup_helpers.py::TestFetchKeyvaultSecretsParallel::test_parallel_fetch_with_failure PASSED [ 94%]
tests/test_setup_helpers.py::TestFetchKeyvaultSecretsParallel::test_mixed_connection_types PASSED [ 95%]
tests/test_setup_helpers.py::TestConfigureConnectionsParallel::test_successful_configuration PASSED [ 96%]
tests/test_setup_helpers.py::TestConfigureConnectionsParallel::test_configuration_with_errors PASSED [ 97%]
tests/test_setup_helpers.py::TestConfigureConnectionsParallel::test_skip_prefetch PASSED [ 97%]
tests/test_setup_helpers.py::TestValidateDatabricksEnvironment::test_non_databricks_environment PASSED [ 98%]
tests/test_setup_helpers.py::TestValidateDatabricksEnvironment::test_databricks_environment PASSED [ 99%]
tests/test_setup_helpers.py::TestValidateDatabricksEnvironment::test_spark_available PASSED [100%]

============================== warnings summary ===============================
tests\test_extras_imports.py:6
  c:\Users\hodibi\OneDrive - Ingredion\Desktop\Repos\Odibi\tests\test_extras_imports.py:6: PytestUnknownMarkWarning: Unknown pytest.mark.extras - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.extras

tests\test_extras_imports.py:19
  c:\Users\hodibi\OneDrive - Ingredion\Desktop\Repos\Odibi\tests\test_extras_imports.py:19: PytestUnknownMarkWarning: Unknown pytest.mark.extras - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.extras

tests\test_extras_imports.py:36
  c:\Users\hodibi\OneDrive - Ingredion\Desktop\Repos\Odibi\tests\test_extras_imports.py:36: PytestUnknownMarkWarning: Unknown pytest.mark.extras - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.extras

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================= 125 passed, 12 skipped, 3 warnings in 4.46s =================
