# process_customers

## Summary

| Metric | Value |
|--------|-------|
| Operation | `transform` |
| Status | âœ… success |
| Duration | 0.1370s |
| Rows In | 6 |
| Rows Out | 5 |
| Rows Written | 5 |
| Row Change | -1 (-16.7%) |

## Schema Changes

**Added:**
- `full_name`

## Schema In

| Column | Type |
|--------|------|
| customer_id | `int64[pyarrow]` |
| first_name | `string[pyarrow]` |
| last_name | `string[pyarrow]` |
| email | `string[pyarrow]` |
| tier | `string[pyarrow]` |
| city | `string[pyarrow]` |
| updated_at | `string[pyarrow]` |

## Schema Out

| Column | Type |
|--------|------|
| customer_id | `int64` |
| first_name | `object` |
| last_name | `object` |
| email | `object` |
| tier | `object` |
| city | `object` |
| updated_at | `object` |
| full_name | `object` |

## Transformations Applied

1. `clean_text`
2. `None`

## Executed SQL

### Query 1

```sql
SELECT * EXCLUDE(_rn) FROM (
            SELECT *,
                   ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY customer_id) as _rn
            FROM df
        ) WHERE _rn = 1
```

### Query 2

```sql
SELECT customer_id, first_name, last_name, LOWER(TRIM(email)) AS email, tier, city, updated_at FROM df
```

### Query 3

```sql
SELECT *,
first_name || ' ' || last_name as full_name
FROM df
```

## Configuration

```yaml
name: process_customers
description: null
runbook_url: null
enabled: true
tags: []
depends_on: []
columns: {}
read:
  connection: raw_data
  format: csv
  table: null
  path: customers.csv
  streaming: false
  schema_ddl: null
  query: null
  filter: null
  incremental: null
  time_travel: null
  archive_options: {}
  options: {}
inputs: null
transform:
  steps:
  - sql: null
    sql_file: null
    function: clean_text
    operation: null
    params:
      columns:
      - email
      case: lower
  - sql: 'SELECT *,

      first_name || '' '' || last_name as full_name

      FROM df

      '
    sql_file: null
    function: null
    operation: null
    params: {}
write:
  connection: delta_lake
  format: delta
  table: null
  path: gold/customers
  register_table: null
  mode: overwrite
  partition_by: []
  zorder_by: []
  table_properties: {}
  merge_schema: false
  first_run_query: null
  options: {}
  auto_optimize: null
  add_metadata: null
  skip_if_unchanged: false
  skip_hash_columns: null
  skip_hash_sort_columns: null
  streaming: null
  merge_keys: null
  merge_options: null
  overwrite_options: null
streaming: false
transformer: deduplicate
params:
  keys:
  - customer_id
  order_by: customer_id
pre_sql: []
post_sql: []
materialized: null
cache: false
log_level: null
on_error: fail_later
validation: null
contracts: []
schema_policy: null
privacy: null
sensitive: false
source_yaml: D:\odibi\examples\starter.odibi.yaml
```

---

*Generated by Odibi on 2026-01-21 10:56:10*
